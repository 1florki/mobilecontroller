 <!DOCTYPE html>
 <meta charset="utf-8" />
 <title>controller</title>

 <body style="background-color:black;">
   <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/6.2.2/browser/pixi.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/peerjs/1.3.2/peerjs.min.js"></script>
   <script src="./../peergamepad.js"></script>
   <script src="./../touchgamepad.js"></script>

   <script>
     // dimensions of controller
     const sW = 1600;
     const sH = 800;
     let scl;

     let gamepad;

     let app = new PIXI.Application({
       width: 500,
       height: 500,
       antialiasing: true,
       transparent: false,
       backgroundColor: 0x111111,
       resolution: window.devicePixelRatio || 1
     });

     document.body.appendChild(app.view);

     let gameContainer, doit, master;

     let currentTouches = {};

     setup();

     function resize() {
       let w = (window.innerWidth - 20) / window.devicePixelRatio;
       let h = (window.innerHeight - 20) / window.devicePixelRatio;
       scl = Math.min(w / sW, h / sH);

       //this part resizes the canvas but keeps ratio the same
       app.renderer.resize(w, h);
       gameContainer.transform.position.set(w * 0.5, h * 0.5);
       gameContainer.transform.scale.set(scl, scl);
     }

     function makeTouch(c) {
       let p = gameContainer.toLocal({
         x: c.clientX / window.devicePixelRatio,
         y: c.clientY / window.devicePixelRatio
       })
       return {
         x: p.x,
         y: p.y,
         id: c.identifier || 1
       };
     }

     function setup() {
       gameContainer = new PIXI.Container();
       app.stage.addChild(gameContainer);
       
       resize();
       
       master = new PeerGamepad({onConnect: () => {
         gamepad = new TouchGamepad({
           elements: [{
             color: 0xff0000,
             type: "joystick",
             size: {
               x: 800,
               y: 800
             },
             pos: {
               x: -400,
               y: 0
             }
           }, {
             pos: {
               x: 300,
               y: 200
             }
           }, {
             pos: {
               x: 600,
               y: 0
             }
           }, {
             pos: {
               x: 300,
               y: -200
             }
           }]
         });
         
       gamepad.addGraphics(gameContainer);
         
       window.addEventListener("touchstart", (evt) => {
         for (let c of evt.changedTouches) {
           gamepad.touchStart(makeTouch(c));
         }
       }, false);
         
       window.addEventListener("touchend", (evt) => {
         for (let c of evt.changedTouches) {
           gamepad.touchEnd(makeTouch(c));
         }
       }, false);
       window.addEventListener("touchcancel", (evt) => {
         for (let c of evt.changedTouches) {
           gamepad.touchEnd(makeTouch(c));
         }
       }, false);
       window.addEventListener("touchmove", (evt) => {
         for (let c of evt.changedTouches) {
           gamepad.touchMove(makeTouch(c));
         }
       }, false);
         
         
         
       window.addEventListener("mousedown", (evt) => {
          gamepad.touchStart(makeTouch(evt));
       }, false);
       window.addEventListener("mouseup", (evt) => {
          gamepad.touchEnd(makeTouch(evt));
       }, false);
       window.addEventListener("mousemove", (evt) => {
          gamepad.touchMove(makeTouch(evt));
       }, false);
       }});
       
       

       window.addEventListener("resize", () => {
         clearTimeout(doit);
         doit = setTimeout(resize, 100);
       }, true);
       
       let ticker = PIXI.Ticker.shared;
       ticker.add(gameloop);
       
     }

     function gameloop(time) {
       let dt = PIXI.Ticker.shared.elapsedMS;
       
       if(gamepad) {
         if(gamepad.hasChanged()) {
           master.sendData(gamepad.getData());
         }
       }
     }

   </script>
 </body>
